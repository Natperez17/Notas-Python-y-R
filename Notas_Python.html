<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>notas_python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="Notas_Python_files/libs/clipboard/clipboard.min.js"></script>
<script src="Notas_Python_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Notas_Python_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Notas_Python_files/libs/quarto-html/popper.min.js"></script>
<script src="Notas_Python_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Notas_Python_files/libs/quarto-html/anchor.min.js"></script>
<link href="Notas_Python_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Notas_Python_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Notas_Python_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Notas_Python_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Notas_Python_files/libs/bootstrap/bootstrap-813c323200a87c37e262811031999de4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#análisis-exploratorio-y-descriptivos" id="toc-análisis-exploratorio-y-descriptivos" class="nav-link active" data-scroll-target="#análisis-exploratorio-y-descriptivos"><span class="header-section-number">1</span> Análisis Exploratorio y Descriptivos</a>
  <ul class="collapse">
  <li><a href="#datos-de-clientes" id="toc-datos-de-clientes" class="nav-link" data-scroll-target="#datos-de-clientes"><span class="header-section-number">1.1</span> Datos de clientes</a></li>
  <li><a href="#descripción-de-datos" id="toc-descripción-de-datos" class="nav-link" data-scroll-target="#descripción-de-datos"><span class="header-section-number">1.2</span> Descripción de datos</a>
  <ul class="collapse">
  <li><a href="#descripción-de-datos-cuantitativos" id="toc-descripción-de-datos-cuantitativos" class="nav-link" data-scroll-target="#descripción-de-datos-cuantitativos"><span class="header-section-number">1.2.1</span> Descripción de datos cuantitativos</a></li>
  <li><a href="#descripción-de-datos-cualitativos" id="toc-descripción-de-datos-cualitativos" class="nav-link" data-scroll-target="#descripción-de-datos-cualitativos"><span class="header-section-number">1.2.2</span> Descripción de datos cualitativos</a></li>
  </ul></li>
  <li><a href="#datos-faltantes" id="toc-datos-faltantes" class="nav-link" data-scroll-target="#datos-faltantes"><span class="header-section-number">1.3</span> Datos faltantes</a></li>
  <li><a href="#modificar-categorías-de-las-variables" id="toc-modificar-categorías-de-las-variables" class="nav-link" data-scroll-target="#modificar-categorías-de-las-variables"><span class="header-section-number">1.4</span> Modificar categorías de las variables</a></li>
  <li><a href="#pruebas-no-paramétricas" id="toc-pruebas-no-paramétricas" class="nav-link" data-scroll-target="#pruebas-no-paramétricas"><span class="header-section-number">1.5</span> Pruebas No paramétricas</a>
  <ul class="collapse">
  <li><a href="#evaluar-normalidad" id="toc-evaluar-normalidad" class="nav-link" data-scroll-target="#evaluar-normalidad"><span class="header-section-number">1.5.1</span> Evaluar normalidad</a></li>
  <li><a href="#correlación" id="toc-correlación" class="nav-link" data-scroll-target="#correlación"><span class="header-section-number">1.5.2</span> Correlación</a></li>
  <li><a href="#u-de-mann-whitney" id="toc-u-de-mann-whitney" class="nav-link" data-scroll-target="#u-de-mann-whitney"><span class="header-section-number">1.5.3</span> U de Mann-Whitney</a></li>
  <li><a href="#otros" id="toc-otros" class="nav-link" data-scroll-target="#otros"><span class="header-section-number">1.5.4</span> Otros</a></li>
  </ul></li>
  <li><a href="#visualización-de-datos" id="toc-visualización-de-datos" class="nav-link" data-scroll-target="#visualización-de-datos"><span class="header-section-number">1.6</span> Visualización de datos</a>
  <ul class="collapse">
  <li><a href="#gráfico-de-barras" id="toc-gráfico-de-barras" class="nav-link" data-scroll-target="#gráfico-de-barras"><span class="header-section-number">1.6.1</span> Gráfico de barras</a></li>
  <li><a href="#boxplot" id="toc-boxplot" class="nav-link" data-scroll-target="#boxplot"><span class="header-section-number">1.6.2</span> Boxplot</a></li>
  <li><a href="#gráfico-de-violín" id="toc-gráfico-de-violín" class="nav-link" data-scroll-target="#gráfico-de-violín"><span class="header-section-number">1.6.3</span> Gráfico de Violín</a></li>
  <li><a href="#gráfico-de-dispersión" id="toc-gráfico-de-dispersión" class="nav-link" data-scroll-target="#gráfico-de-dispersión"><span class="header-section-number">1.6.4</span> Gráfico de Dispersión</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#modelos" id="toc-modelos" class="nav-link" data-scroll-target="#modelos"><span class="header-section-number">2</span> Modelos</a>
  <ul class="collapse">
  <li><a href="#modelo-lineal-simple" id="toc-modelo-lineal-simple" class="nav-link" data-scroll-target="#modelo-lineal-simple"><span class="header-section-number">2.1</span> Modelo Lineal Simple</a></li>
  </ul></li>
  <li><a href="#modelo-lineal-múltiple" id="toc-modelo-lineal-múltiple" class="nav-link" data-scroll-target="#modelo-lineal-múltiple"><span class="header-section-number">3</span> Modelo Lineal Múltiple</a>
  <ul class="collapse">
  <li><a href="#modelo-logístico-simple" id="toc-modelo-logístico-simple" class="nav-link" data-scroll-target="#modelo-logístico-simple"><span class="header-section-number">3.1</span> Modelo Logístico Simple</a></li>
  <li><a href="#validación-cruzada-modelo-logístico" id="toc-validación-cruzada-modelo-logístico" class="nav-link" data-scroll-target="#validación-cruzada-modelo-logístico"><span class="header-section-number">3.2</span> Validación Cruzada Modelo Logístico</a></li>
  <li><a href="#ridge" id="toc-ridge" class="nav-link" data-scroll-target="#ridge"><span class="header-section-number">3.3</span> Ridge</a></li>
  <li><a href="#lasso" id="toc-lasso" class="nav-link" data-scroll-target="#lasso"><span class="header-section-number">3.4</span> Lasso</a>
  <ul class="collapse">
  <li><a href="#comparación-ridge-y-lasso" id="toc-comparación-ridge-y-lasso" class="nav-link" data-scroll-target="#comparación-ridge-y-lasso"><span class="header-section-number">3.4.1</span> Comparación Ridge y Lasso</a></li>
  </ul></li>
  <li><a href="#elastin-net" id="toc-elastin-net" class="nav-link" data-scroll-target="#elastin-net"><span class="header-section-number">3.5</span> Elastin net</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introducción</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="58fdf2c5" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar librerías</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Estas notas fueron realizadas con la finalidad de ser un recurso fundamental para el análisis de datos. Una guía que permita agilizar y tomar decisiones rápidas en cuanto a los procedimientos ideales para el procesamiento, análisis, inferencia y viasualización de datos en R.</p>
<p>Nota: Todos los recursos empleados en este documento son extraídos de notas de clases, páginas web y propios.</p>
<section id="análisis-exploratorio-y-descriptivos" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Análisis Exploratorio y Descriptivos</h1>
<p>Uno de los pasos más importantes al realizar un análisis de datos, es explorar y describir los datos con los que se cuentan. En esta sección se revisará temas como: Datos faltantes, reemplazar valores, visualización de datos e incluso prubas no parámetricas.</p>
<section id="datos-de-clientes" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="datos-de-clientes"><span class="header-section-number">1.1</span> Datos de clientes</h2>
<p>La base de datos data_clientes contiene información de los clientes de una Cooperativa, se cuentan con 4117 registro y 11 columnas con variables que incluyen un identificador único, así como características sociodemográficas como la edad, el género y el estado civil. También recoge variables económicas como los ingresos anuales, el número de hijos, el número de tarjetas, la modalidad de pago, la tenencia de hipoteca y el número de préstamos activos. Finalmente, incluye la variable RIESGO, que clasifica a los clientes según su perfil crediticio, y puede ser utilizada como variable objetivo en modelos de predicción o segmentación.</p>
<div id="e5f07f21" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar base de datos</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_clientes <span class="op">=</span> pd.read_csv(<span class="st">"C:/Users/natal/Escritorio/Semestres/Semestre 10/Mineria/Data Clientes Cooperativa.txt"</span>, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, na_values<span class="op">=</span>[<span class="st">"NA"</span>, <span class="st">" "</span>, <span class="st">""</span>])</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Revisar los primeros 6 registros de la base de datos</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data_clientes.head()</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Estructura e información de la base de datos</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>data_clientes.info()</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Estadísticas descriptivas de las variables de la base de datos</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>data_clientes.describe()</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>data_clientes[<span class="st">'ID'</span>].unique() <span class="co"># Devuelve los valores únicos de la variable ID</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 4117 entries, 0 to 4116
Data columns (total 11 columns):
 #   Column          Non-Null Count  Dtype 
---  ------          --------------  ----- 
 0   ID              4117 non-null   int64 
 1   EDAD            4117 non-null   int64 
 2   INGRESOS        4117 non-null   int64 
 3   GENERO          4116 non-null   object
 4   ESTADO_CIVIL    4117 non-null   object
 5   NUM_HIJOS       4117 non-null   int64 
 6   NUM_TARJETAS    4117 non-null   int64 
 7   MODALIDAD_PAGO  4117 non-null   object
 8   HIPOTECA        4117 non-null   object
 9   PRESTAMOS       4117 non-null   int64 
 10  RIESGO          4117 non-null   object
dtypes: int64(6), object(5)
memory usage: 353.9+ KB</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="194">
<pre><code>array([100756, 100668, 100418, ..., 101983, 101819, 103676], shape=(4117,))</code></pre>
</div>
</div>
</section>
<section id="descripción-de-datos" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="descripción-de-datos"><span class="header-section-number">1.2</span> Descripción de datos</h2>
<section id="descripción-de-datos-cuantitativos" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="descripción-de-datos-cuantitativos"><span class="header-section-number">1.2.1</span> Descripción de datos cuantitativos</h3>
<p>Este código permite obtener información detallada de las estadísticas descriptivas para las variables numéricas, como el n, desviación estándar, IQR, etc. Esta información es mucho más completa que el describe().</p>
<div id="b57edd1d" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>variables_Num <span class="op">=</span> [<span class="st">'EDAD'</span>, <span class="st">'INGRESOS'</span>, <span class="st">'NUM_HIJOS'</span>, <span class="st">'NUM_TARJETAS'</span>, <span class="st">'PRESTAMOS'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Diccionario para almacenar los resultados</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>resumen <span class="op">=</span> {}</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Recorremos cada variable y calculamos las estadísticas</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var <span class="kw">in</span> variables_Num:</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> data_clientes[var].dropna()</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    resumen[var] <span class="op">=</span> {</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'n'</span>: <span class="bu">len</span>(x),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'media'</span>: <span class="bu">round</span>(np.mean(x), <span class="dv">2</span>),</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Desv.Est'</span>: <span class="bu">round</span>(np.std(x, ddof<span class="op">=</span><span class="dv">1</span>), <span class="dv">2</span>),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'mediana'</span>: <span class="bu">round</span>(np.median(x), <span class="dv">2</span>),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'IQR'</span>: <span class="bu">round</span>(np.percentile(x, <span class="dv">75</span>) <span class="op">-</span> np.percentile(x, <span class="dv">25</span>), <span class="dv">2</span>),</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Percentil25'</span>: <span class="bu">round</span>(np.percentile(x, <span class="dv">25</span>), <span class="dv">2</span>),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Percentil75'</span>: <span class="bu">round</span>(np.percentile(x, <span class="dv">75</span>), <span class="dv">2</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Percentil95'</span>: <span class="bu">round</span>(np.percentile(x, <span class="dv">95</span>), <span class="dv">2</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertimos el diccionario a un DataFrame y lo transponemos</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>tabla_descrip <span class="op">=</span> pd.DataFrame(resumen)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostramos solo la tabla final completa</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tabla_descrip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                EDAD  INGRESOS  NUM_HIJOS  NUM_TARJETAS  PRESTAMOS
n            4117.00   4117.00    4117.00       4117.00    4117.00
media          31.82  25580.21       1.45          2.43       1.38
Desv.Est        9.88   8766.87       1.17          1.88       0.84
mediana        31.00  23490.00       1.00          2.00       1.00
IQR            18.00   7069.00       1.00          3.00       1.00
Percentil25    23.00  20497.00       1.00          1.00       1.00
Percentil75    41.00  27566.00       2.00          4.00       2.00
Percentil95    48.00  44773.80       4.00          6.00       3.00</code></pre>
</div>
</div>
</section>
<section id="descripción-de-datos-cualitativos" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="descripción-de-datos-cualitativos"><span class="header-section-number">1.2.2</span> Descripción de datos cualitativos</h3>
<p>Este código genera las frecuencias absolutas y relativas para todas las variables cualitativas a tráves de un for</p>
<div id="207ff11a" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>variables_Cat <span class="op">=</span> [<span class="st">'GENERO'</span>, <span class="st">'ESTADO_CIVIL'</span>, <span class="st">'MODALIDAD_PAGO'</span>, <span class="st">'HIPOTECA'</span>, <span class="st">'RIESGO'</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>FrecA_tablas_Cat <span class="op">=</span> {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  var: data_clientes[var].value_counts(dropna<span class="op">=</span><span class="va">False</span>).reset_index().rename(columns<span class="op">=</span>{</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'index'</span>: var,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    var: <span class="st">'Frecuencia'</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  }) <span class="cf">for</span> var <span class="kw">in</span> variables_Cat</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>FrecA_tablas_Cat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="196">
<pre><code>{'GENERO':   Frecuencia  count
 0          f   2077
 1          m   2039
 2        NaN      1,
 'ESTADO_CIVIL':   Frecuencia  count
 0    married   2089
 1     single   1155
 2  divsepwid    873,
 'MODALIDAD_PAGO':   Frecuencia  count
 0     weekly   2091
 1    monthly   2026,
 'HIPOTECA':   Frecuencia  count
 0          y   3200
 1          n    917,
 'RIESGO':   Frecuencia  count
 0          F   3313
 1          V    804}</code></pre>
</div>
</div>
<div id="7c2a46b1" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>FrecR_tablas_Cat <span class="op">=</span> {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  var: data_clientes[var].value_counts(normalize<span class="op">=</span><span class="va">True</span>,dropna<span class="op">=</span><span class="va">False</span>).reset_index().rename(columns<span class="op">=</span>{</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'index'</span>: var,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    var: <span class="st">'Frecuencia'</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  }) <span class="cf">for</span> var <span class="kw">in</span> variables_Cat</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>FrecR_tablas_Cat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="197">
<pre><code>{'GENERO':   Frecuencia  proportion
 0          f    0.504494
 1          m    0.495264
 2        NaN    0.000243,
 'ESTADO_CIVIL':   Frecuencia  proportion
 0    married    0.507408
 1     single    0.280544
 2  divsepwid    0.212048,
 'MODALIDAD_PAGO':   Frecuencia  proportion
 0     weekly    0.507894
 1    monthly    0.492106,
 'HIPOTECA':   Frecuencia  proportion
 0          y    0.777265
 1          n    0.222735,
 'RIESGO':   Frecuencia  proportion
 0          F    0.804712
 1          V    0.195288}</code></pre>
</div>
</div>
</section>
</section>
<section id="datos-faltantes" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="datos-faltantes"><span class="header-section-number">1.3</span> Datos faltantes</h2>
<p>La figura es muy útil para visualizar los datos faltantes por variable. En este caso hay muy pocos por lo que no se logran ver.</p>
<div id="db3729a8" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> missingno <span class="im">as</span> msno</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>msno.matrix(data_clientes)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Datos faltantes "</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Notas_Python_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="5528d872" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data_clientes.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="199">
<pre><code>ID                0
EDAD              0
INGRESOS          0
GENERO            1
ESTADO_CIVIL      0
NUM_HIJOS         0
NUM_TARJETAS      0
MODALIDAD_PAGO    0
HIPOTECA          0
PRESTAMOS         0
RIESGO            0
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="modificar-categorías-de-las-variables" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="modificar-categorías-de-las-variables"><span class="header-section-number">1.4</span> Modificar categorías de las variables</h2>
<div id="6ccc7d0d" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>data_clientes[<span class="st">'GENERO'</span>] <span class="op">=</span> data_clientes[<span class="st">'GENERO'</span>].replace({<span class="st">'f'</span>: <span class="st">'Femenino'</span>, <span class="st">'m'</span>: <span class="st">'Masculino'</span>})</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>data_clientes[<span class="st">'ESTADO_CIVIL'</span>] <span class="op">=</span> data_clientes[<span class="st">'ESTADO_CIVIL'</span>].replace({<span class="st">'divsepwid'</span>: <span class="st">'Viudo/Divorciado'</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="st">'married'</span>: <span class="st">'Casado'</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="st">'single'</span>:<span class="st">'Soltero'</span>})</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>data_clientes[<span class="st">'MODALIDAD_PAGO'</span>] <span class="op">=</span> data_clientes[<span class="st">'MODALIDAD_PAGO'</span>].replace({<span class="st">'monthly'</span>: <span class="st">'Mensual'</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="st">'weekly'</span>: <span class="st">'Semanal'</span>})</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>data_clientes[<span class="st">'HIPOTECA'</span>] <span class="op">=</span> data_clientes[<span class="st">'HIPOTECA'</span>].replace({<span class="st">'n'</span>: <span class="st">'NO'</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="st">'y'</span>: <span class="st">'SI'</span>})</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>data_clientes[<span class="st">'RIESGO'</span>] <span class="op">=</span> data_clientes[<span class="st">'RIESGO'</span>].replace({<span class="st">'F'</span>:<span class="st">'Cumplimiento'</span>, <span class="st">'V'</span>: <span class="st">'Impago'</span>})</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>data_clientes.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="200">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">ID</th>
<th data-quarto-table-cell-role="th">EDAD</th>
<th data-quarto-table-cell-role="th">INGRESOS</th>
<th data-quarto-table-cell-role="th">GENERO</th>
<th data-quarto-table-cell-role="th">ESTADO_CIVIL</th>
<th data-quarto-table-cell-role="th">NUM_HIJOS</th>
<th data-quarto-table-cell-role="th">NUM_TARJETAS</th>
<th data-quarto-table-cell-role="th">MODALIDAD_PAGO</th>
<th data-quarto-table-cell-role="th">HIPOTECA</th>
<th data-quarto-table-cell-role="th">PRESTAMOS</th>
<th data-quarto-table-cell-role="th">RIESGO</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>100756</td>
<td>44</td>
<td>59944</td>
<td>Masculino</td>
<td>Casado</td>
<td>1</td>
<td>2</td>
<td>Mensual</td>
<td>SI</td>
<td>0</td>
<td>Impago</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>100668</td>
<td>35</td>
<td>59692</td>
<td>NaN</td>
<td>Casado</td>
<td>1</td>
<td>1</td>
<td>Mensual</td>
<td>SI</td>
<td>0</td>
<td>Cumplimiento</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>100418</td>
<td>34</td>
<td>59508</td>
<td>Masculino</td>
<td>Casado</td>
<td>1</td>
<td>1</td>
<td>Mensual</td>
<td>SI</td>
<td>1</td>
<td>Impago</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>100416</td>
<td>34</td>
<td>59463</td>
<td>Masculino</td>
<td>Casado</td>
<td>0</td>
<td>2</td>
<td>Mensual</td>
<td>SI</td>
<td>1</td>
<td>Cumplimiento</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>100590</td>
<td>39</td>
<td>59393</td>
<td>Femenino</td>
<td>Casado</td>
<td>0</td>
<td>2</td>
<td>Mensual</td>
<td>SI</td>
<td>0</td>
<td>Impago</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="pruebas-no-paramétricas" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="pruebas-no-paramétricas"><span class="header-section-number">1.5</span> Pruebas No paramétricas</h2>
<p>La pruebas parámétricas son esenciales cuando se quiere realizar análisis bivariados sin asumir una distribución específica de los datos queu generalemnte es la normalidad. Existen varias pruebas para realizar inferencias respecto a las relaciones, sin embargo hay ciertas condiciones que se deben tener en cuenta como lo muestra la siguiente tabla:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 27%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>Tipo de Variables Comparadas</th>
<th>Condición</th>
<th>Prueba Estadística</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>2 variables numéricas</strong></td>
<td>Distribución normal</td>
<td><strong>Correlación de Pearson</strong></td>
</tr>
<tr class="even">
<td></td>
<td>No normal</td>
<td><strong>Correlación de Spearman</strong></td>
</tr>
<tr class="odd">
<td><strong>1 variable numérica + 1 categórica</strong></td>
<td>Distribución normal</td>
<td>2 categorías: <strong>t de Student</strong></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>&gt;2 categorías: <strong>ANOVA</strong></td>
</tr>
<tr class="odd">
<td></td>
<td>No normal</td>
<td>2 categorías: <strong>U de Mann-Whitney</strong></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>&gt;2 categorías: <strong>Kruskal-Wallis</strong></td>
</tr>
<tr class="odd">
<td><strong>2 variables categóricas</strong></td>
<td>Tabla 2x2</td>
<td><strong>Test de Fisher</strong></td>
</tr>
<tr class="even">
<td></td>
<td>Tabla r x s (&gt;2 categorías)</td>
<td><strong>Chi-cuadrado (χ²)</strong></td>
</tr>
</tbody>
</table>
<section id="evaluar-normalidad" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="evaluar-normalidad"><span class="header-section-number">1.5.1</span> Evaluar normalidad</h3>
<p>La prueba de Shapiro-Wilk se utiliza para evualar la normalidad de una variable, el comando es shapiro.test().</p>
<p>(H₀): Los datos provienen de una distribución normal.</p>
<p>(H₁): Los datos no provienen de una distribución normal.</p>
<p><strong>Interpretación del p-valor</strong>:</p>
<p>Si <strong>p &gt; 0.05</strong>: no se rechaza H₀ → los datos son compatibles con una distribución normal.</p>
<p>Si <strong>p ≤ 0.05</strong>: se rechaza H₀ → los datos no siguen una distribución normal.</p>
<div id="d936a728" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> shapiro</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>Norm_tablas_Num <span class="op">=</span> {var: shapiro(data_clientes[var].dropna()) <span class="cf">for</span> var <span class="kw">in</span> variables_Num}</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> var, resultado <span class="kw">in</span> Norm_tablas_Num.items():</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>var<span class="sc">}</span><span class="ss">: W=</span><span class="sc">{</span>resultado<span class="sc">.</span>statistic<span class="sc">:4f}</span><span class="ss">, p-value=</span><span class="sc">{</span>resultado<span class="sc">.</span>pvalue<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>EDAD: W=0.916218, p-value=0.0000
INGRESOS: W=0.826751, p-value=0.0000
NUM_HIJOS: W=0.887751, p-value=0.0000
NUM_TARJETAS: W=0.885179, p-value=0.0000
PRESTAMOS: W=0.862041, p-value=0.0000</code></pre>
</div>
</div>
</section>
<section id="correlación" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="correlación"><span class="header-section-number">1.5.2</span> Correlación</h3>
<p>Es una medida estadística que indica la fuerza y dirección de una relación lineal entre dos variables cuantitativas.El resultado se encuentra en un rango entre [-1,1]. <strong>-1</strong> : Correlación negativa perfecta (una variable sube y otra baja) <strong>0</strong>: No hay correlación <strong>1</strong>: Correlación positiva perfecta (ambas variables aumentan o disminuyen juntas)</p>
<div id="0ede7026" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data_clientes[<span class="st">'INGRESOS'</span>].corr(data_clientes[<span class="st">'EDAD'</span>], method<span class="op">=</span><span class="st">'spearman'</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear la matriz de correlación con método Spearman</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>matriz_cor <span class="op">=</span> data_clientes[variables_Num].corr(method<span class="op">=</span><span class="st">'spearman'</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> np.triu(np.ones_like(matriz_cor, dtype<span class="op">=</span><span class="bu">bool</span>))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear mapa de calor con los coeficientes</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>sns.heatmap(matriz_cor,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>            mask<span class="op">=</span>mask,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>            annot <span class="op">=</span> <span class="va">True</span>,     <span class="co"># Mostrar los valores numéricos</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>            fmt<span class="op">=</span><span class="st">'.2f'</span>,   <span class="co"># Formato de decimales</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>            cmap<span class="op">=</span><span class="st">'coolwarm'</span>, <span class="co"># Paleta de colores</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>            square<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>            linewidths<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>            cbar_kws<span class="op">=</span>{<span class="st">'shrink'</span>: <span class="fl">.75</span>})</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Matriz de correlación (Spearman)'</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Notas_Python_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="u-de-mann-whitney" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="u-de-mann-whitney"><span class="header-section-number">1.5.3</span> U de Mann-Whitney</h3>
<p>Esta prueba evalúa si hay diferencia entre las medianas de los grupos.El comando difiere al nombre ya que es wilcox.test().</p>
<p>(H₀): La mediana de los grupos son iguales.</p>
<p>(H₁): La mediana de los grupos son diferentes.</p>
<p>Si <strong>p ≤ 0.05</strong>: se rechaza H₀ → Hay diferencia en las medianas de los grupos.</p>
<div id="b0940950" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> mannwhitneyu</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Separar los grupos según el género</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>ingresos_f <span class="op">=</span> data_clientes[data_clientes[<span class="st">'GENERO'</span>] <span class="op">==</span> <span class="st">'Femenino'</span>][<span class="st">'INGRESOS'</span>].dropna() </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>ingresos_m <span class="op">=</span> data_clientes[data_clientes[<span class="st">'GENERO'</span>] <span class="op">==</span> <span class="st">'Masculino'</span>][<span class="st">'INGRESOS'</span>].dropna()</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Prueba de Mann-Whitney (equivalente a Wilcoxon para muestras indepepndientes)</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>stat, p <span class="op">=</span> mannwhitneyu(ingresos_f, ingresos_m, alternative <span class="op">=</span> <span class="st">'two-sided'</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'Estadístico U=</span><span class="sc">{</span>stat<span class="sc">:4f}</span><span class="ss">, p.value = </span><span class="sc">{</span>p<span class="sc">:4f}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Estadístico U=2088984.000000, p.value = 0.454382</code></pre>
</div>
</div>
</section>
<section id="otros" class="level3" data-number="1.5.4">
<h3 data-number="1.5.4" class="anchored" data-anchor-id="otros"><span class="header-section-number">1.5.4</span> Otros</h3>
<p>Para T-Student y ANOVA se evalúa la diferencia entre las medias de los grupos. Parael test de Kruskall Wallis la diferencia entre las medianas de los grupos. Para el Test de fisher y Chi-cuadrado se evalúa la indepencia. Siempre se busca rechazar la Hiótesis nula, es decir, <strong>p ≤ 0.05</strong>.</p>
<p><strong>T-Student</strong></p>
<div id="04d5168b" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> ttest_ind</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>grupo1 <span class="op">=</span> data_clientes[data_clientes[<span class="st">'GENERO'</span>] <span class="op">==</span><span class="st">'Femenino'</span>][<span class="st">'INGRESOS'</span>].dropna()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>grupo2 <span class="op">=</span> data_clientes[data_clientes[<span class="st">'GENERO'</span>] <span class="op">==</span><span class="st">'Masculino'</span>][<span class="st">'INGRESOS'</span>].dropna()</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>t_stat, p_val <span class="op">=</span> ttest_ind(grupo1, grupo2, equal_var<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>ANOVA</strong></p>
<div id="210aa16c" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.anova <span class="im">import</span> anova_lm</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>modelo <span class="op">=</span>smf.ols(<span class="st">'INGRESOS ~ ESTADO_CIVIL'</span>, data <span class="op">=</span> data_clientes).fit()</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>anova <span class="op">=</span> anova_lm(modelo)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(anova)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de Barlett (Homogeneidad de varianzas)</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#from scipy.stats import barlett</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>grupo1 <span class="op">=</span> data_clientes[data_clientes[<span class="st">"ESTADO_CIVIL"</span>] <span class="op">==</span> <span class="st">"Soltero"</span>][<span class="st">"INGRESOS"</span>].dropna()</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>grupo2 <span class="op">=</span> data_clientes[data_clientes[<span class="st">"ESTADO_CIVIL"</span>] <span class="op">==</span> <span class="st">"Casado"</span>][<span class="st">"INGRESOS"</span>].dropna()</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>grupo3 <span class="op">=</span> data_clientes[data_clientes[<span class="st">"ESTADO_CIVIL"</span>] <span class="op">==</span> <span class="st">"Viudo/Divorciado"</span>][<span class="st">"INGRESOS"</span>].dropna()</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co">#barlett_stat, p_barlett = barlett(grupo1, grupo2, grupo3)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                  df        sum_sq       mean_sq           F        PR(&gt;F)
ESTADO_CIVIL     2.0  1.695835e+10  8.479174e+09  116.515031  6.016876e-50
Residual      4114.0  2.993890e+11  7.277322e+07         NaN           NaN</code></pre>
</div>
</div>
<p><strong>Kruskal Wallis</strong></p>
<div id="f620f617" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> kruskal</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>kruskal_stats, p_kruskal <span class="op">=</span> kruskal(grupo1, grupo2, grupo3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Test de fisher</strong></p>
<div id="ba62b040" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> fisher_exact</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>tabla <span class="op">=</span>pd.crosstab(data_clientes[<span class="st">'HIPOTECA'</span>], data_clientes[<span class="st">'RIESGO'</span>])</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>oddsratio, p_fisher <span class="op">=</span> fisher_exact(tabla)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Chi-cuadrado</strong></p>
<div id="8059a8aa" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> chi2_contingency</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>tabla <span class="op">=</span> pd.crosstab(data_clientes[<span class="st">'GENERO'</span>], data_clientes[<span class="st">'RIESGO'</span>])</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>chi2, p_chi, dof, expected <span class="op">=</span> chi2_contingency(tabla)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="visualización-de-datos" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="visualización-de-datos"><span class="header-section-number">1.6</span> Visualización de datos</h2>
<section id="gráfico-de-barras" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="gráfico-de-barras"><span class="header-section-number">1.6.1</span> Gráfico de barras</h3>
<div id="d97ba97a" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Colores personalizados</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>colores <span class="op">=</span> [<span class="st">"#1C86EE"</span>, <span class="st">"#458B00"</span>, <span class="st">"#EE1289"</span>]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear grafíco</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>grafico <span class="op">=</span> sns.countplot(</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  data<span class="op">=</span>data_clientes,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> <span class="st">'ESTADO_CIVIL'</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  hue<span class="op">=</span> <span class="st">'ESTADO_CIVIL'</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  palette<span class="op">=</span>colores</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> grafico.patches:</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  grafico.text(p.get_x() <span class="op">+</span> p.get_width()<span class="op">/</span><span class="dv">2</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  p.get_height(),</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="bu">int</span>(p.get_height()),</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  ha <span class="op">=</span> <span class="st">'center'</span>, va<span class="op">=</span><span class="st">'bottom'</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Conteo de la variable Estado Civil por categoría'</span>)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Estado civil'</span>)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Frecuencia Absoluta'</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Notas_Python_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplot" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="boxplot"><span class="header-section-number">1.6.2</span> Boxplot</h3>
<div id="54391e71" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  data<span class="op">=</span>data_clientes,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> <span class="st">'GENERO'</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> <span class="st">'INGRESOS'</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  color <span class="op">=</span> <span class="st">'#1C86EE'</span>,)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gráfico de cajas: Ingresos por Género'</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Género'</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Ingresos'</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Notas_Python_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gráfico-de-violín" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3" class="anchored" data-anchor-id="gráfico-de-violín"><span class="header-section-number">1.6.3</span> Gráfico de Violín</h3>
<div id="69d0cc91" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sns.violinplot(x<span class="op">=</span><span class="st">'RIESGO'</span>, y<span class="op">=</span><span class="st">'PRESTAMOS'</span>, data<span class="op">=</span>data_clientes)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Riesgo de incumplimiento por Número de Préstamos'</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Riesgo de incumplimiento'</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Notas_Python_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gráfico-de-dispersión" class="level3" data-number="1.6.4">
<h3 data-number="1.6.4" class="anchored" data-anchor-id="gráfico-de-dispersión"><span class="header-section-number">1.6.4</span> Gráfico de Dispersión</h3>
<div id="f44b4a85" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data <span class="op">=</span> data_clientes, x<span class="op">=</span> <span class="st">'EDAD'</span>, y<span class="op">=</span> <span class="st">'INGRESOS'</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gráfico de dispersión Edad vs Ingresos'</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Notas_Python_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="modelos" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Modelos</h1>
<section id="modelo-lineal-simple" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="modelo-lineal-simple"><span class="header-section-number">2.1</span> Modelo Lineal Simple</h2>
<div id="f3c0d515" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importar librerías</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> linear_model</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="b151e665" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>data_clientes[<span class="st">'RIESGO_bin'</span>] <span class="op">=</span> data_clientes[<span class="st">'RIESGO'</span>].<span class="bu">map</span>({<span class="st">'Cumplimiento'</span>: <span class="dv">0</span>, <span class="st">'Impago'</span>:<span class="dv">1</span>})</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>data_clientes[<span class="st">'RIESGO_bin'</span>].unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="214">
<pre><code>array([1, 0])</code></pre>
</div>
</div>
<div id="ef1a2508" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(data_clientes[[<span class="st">'RIESGO_bin'</span>]], prepend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_clientes[<span class="st">'INGRESOS'</span>]</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>modelo <span class="op">=</span> sm.OLS(endog<span class="op">=</span>y, exog<span class="op">=</span>X)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>resultado <span class="op">=</span> modelo.fit()</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(resultado.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:               INGRESOS   R-squared:                       0.230
Model:                            OLS   Adj. R-squared:                  0.230
Method:                 Least Squares   F-statistic:                     1233.
Date:                Tue, 29 Jul 2025   Prob (F-statistic):          2.02e-236
Time:                        15:35:44   Log-Likelihood:                -42679.
No. Observations:                4117   AIC:                         8.536e+04
Df Residuals:                    4115   BIC:                         8.537e+04
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
const       2.351e+04    133.627    175.915      0.000    2.32e+04    2.38e+04
RIESGO_bin  1.062e+04    302.383     35.107      0.000       1e+04    1.12e+04
==============================================================================
Omnibus:                     1119.526   Durbin-Watson:                   0.418
Prob(Omnibus):                  0.000   Jarque-Bera (JB):             3372.579
Skew:                           1.396   Prob(JB):                         0.00
Kurtosis:                       6.445   Cond. No.                         2.64
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
</section>
</section>
<section id="modelo-lineal-múltiple" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Modelo Lineal Múltiple</h1>
<div id="74bae4dd" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_clientes.drop(columns<span class="op">=</span>[<span class="st">'ID'</span>, <span class="st">'INGRESOS'</span>, <span class="st">'RIESGO_bin'</span>])</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.get_dummies(X, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X, prepend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_clientes[<span class="st">'INGRESOS'</span>]</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> X.astype(<span class="bu">float</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> y.astype(<span class="bu">float</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>modelo <span class="op">=</span> sm.OLS(endog<span class="op">=</span>y, exog<span class="op">=</span>X)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>modelo <span class="op">=</span> modelo.fit()</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modelo.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:               INGRESOS   R-squared:                       0.556
Model:                            OLS   Adj. R-squared:                  0.555
Method:                 Least Squares   F-statistic:                     514.6
Date:                Tue, 29 Jul 2025   Prob (F-statistic):               0.00
Time:                        15:35:44   Log-Likelihood:                -41546.
No. Observations:                4117   AIC:                         8.311e+04
Df Residuals:                    4106   BIC:                         8.318e+04
Df Model:                          10                                         
Covariance Type:            nonrobust                                         
=================================================================================================
                                    coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------------------------
const                          2.977e+04    580.615     51.269      0.000    2.86e+04    3.09e+04
EDAD                            267.9552     13.230     20.253      0.000     242.017     293.894
NUM_HIJOS                     -3088.5285    137.398    -22.479      0.000   -3357.903   -2819.154
NUM_TARJETAS                    123.2159    102.014      1.208      0.227     -76.786     323.218
PRESTAMOS                     -4259.9497    192.182    -22.166      0.000   -4636.730   -3883.170
GENERO_Masculino                476.3723    182.335      2.613      0.009     118.897     833.848
ESTADO_CIVIL_Soltero          -8705.9853    289.187    -30.105      0.000   -9272.949   -8139.021
ESTADO_CIVIL_Viudo/Divorciado  3605.0657    496.774      7.257      0.000    2631.119    4579.013
MODALIDAD_PAGO_Semanal        -2773.4564    227.939    -12.168      0.000   -3220.341   -2326.572
HIPOTECA_SI                    -787.2875    269.480     -2.922      0.004   -1315.614    -258.961
RIESGO_Impago                  4079.5094    268.843     15.174      0.000    3552.432    4606.587
==============================================================================
Omnibus:                      299.758   Durbin-Watson:                   0.896
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              578.914
Skew:                           0.507   Prob(JB):                    1.95e-126
Kurtosis:                       4.532   Cond. No.                         246.
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
<section id="modelo-logístico-simple" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="modelo-logístico-simple"><span class="header-section-number">3.1</span> Modelo Logístico Simple</h2>
<div id="0bf8cf8f" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar librerías</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.weightstats <span class="im">import</span> ttest_ind</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Configurar warnings</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="5a57ddd7" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(data_clientes[[<span class="st">'EDAD'</span>]], prepend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_clientes[<span class="st">'RIESGO_bin'</span>]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>modelo_LSimple <span class="op">=</span> sm.Logit(endog<span class="op">=</span>y, exog<span class="op">=</span>X)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>modelo_LSimple <span class="op">=</span> modelo_LSimple.fit()</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modelo_LSimple.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.468490
         Iterations 6
                           Logit Regression Results                           
==============================================================================
Dep. Variable:             RIESGO_bin   No. Observations:                 4117
Model:                          Logit   Df Residuals:                     4115
Method:                           MLE   Df Model:                            1
Date:                Tue, 29 Jul 2025   Pseudo R-squ.:                 0.05126
Time:                        15:35:45   Log-Likelihood:                -1928.8
converged:                       True   LL-Null:                       -2033.0
Covariance Type:            nonrobust   LLR p-value:                 3.060e-47
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
const         -3.3630      0.151    -22.299      0.000      -3.659      -3.067
EDAD           0.0581      0.004     14.059      0.000       0.050       0.066
==============================================================================</code></pre>
</div>
</div>
<div id="81d964e9" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"AIC:"</span>, modelo_LSimple.aic)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"BIC:"</span>, modelo_LSimple.bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 3861.544728597293
BIC: 3874.190488640833</code></pre>
</div>
</div>
<div id="8e3c8568" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_auc_score</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Se hace un nuevo modelo porque el AUC funciona con LogisticRegression en ves de sm.Logit</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>modelo_LSimple2 <span class="op">=</span> LogisticRegression()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>modelo_LSimple2.fit(X, y)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>y_prob <span class="op">=</span> modelo_LSimple2.predict_proba(X)[:, <span class="dv">1</span>]</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>auc <span class="op">=</span> roc_auc_score(y, y_prob)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"AUC:"</span>, auc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>AUC: 0.6706437252313739</code></pre>
</div>
</div>
</section>
<section id="validación-cruzada-modelo-logístico" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="validación-cruzada-modelo-logístico"><span class="header-section-number">3.2</span> Validación Cruzada Modelo Logístico</h2>
<div id="7dd353d7" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_clientes.drop(columns<span class="op">=</span>[<span class="st">'ID'</span>, <span class="st">'RIESGO'</span>, <span class="st">'RIESGO_bin'</span>])</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.get_dummies(X, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> sm.add_constant(X, prepend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_clientes[<span class="st">'RIESGO_bin'</span>]</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Unir X e y para eliminar filas con NaN en cualquiera</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>df_modelo <span class="op">=</span> pd.concat([X, y], axis<span class="op">=</span><span class="dv">1</span>).dropna()</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_modelo.drop(columns<span class="op">=</span>[<span class="st">'RIESGO_bin'</span>]).astype(<span class="bu">float</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_modelo[<span class="st">'RIESGO_bin'</span>].astype(<span class="bu">float</span>)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, <span class="co"># Convierte X en un array de Numpy (haciendo tantas filas como sea necesario)</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>y, <span class="co"># Convierte Y en un array de Numpy (haciendo tantas filas como sea necesario)</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>train_size <span class="op">=</span> <span class="fl">0.8</span>, <span class="co"># Se usarán el 80% de los registros para entrenar el modelo</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>random_state <span class="op">=</span><span class="dv">1234</span>, <span class="co"># Fijar semilla (Creo que no hace falta)</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>shuffle <span class="op">=</span> <span class="va">True</span>) <span class="co"># Mezcla aleatoriamente todos los datos antes de dividirlos (Creo que tampoco hace falta)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="40c71fe5" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> sm.add_constant(X_train, prepend<span class="op">=</span><span class="va">True</span>) <span class="co"># Agrega una columna al principio para el intercepto</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>modelo_LMultiple <span class="op">=</span> sm.Logit(endog<span class="op">=</span>y_train, exog<span class="op">=</span>X_train) <span class="co"># Inicializa un modelo de regresión logística</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>modelo_LMultiple <span class="op">=</span> modelo_LMultiple.fit() <span class="co"># Ajustar modelo</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(modelo_LMultiple.summary()) <span class="co"># Imprimir el resumen del modelo</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.349677
         Iterations 7
                           Logit Regression Results                           
==============================================================================
Dep. Variable:             RIESGO_bin   No. Observations:                 3293
Model:                          Logit   Df Residuals:                     3282
Method:                           MLE   Df Model:                           10
Date:                Tue, 29 Jul 2025   Pseudo R-squ.:                  0.2937
Time:                        15:35:45   Log-Likelihood:                -1151.5
converged:                       True   LL-Null:                       -1630.2
Covariance Type:            nonrobust   LLR p-value:                2.745e-199
=================================================================================================
                                    coef    std err          z      P&gt;|z|      [0.025      0.975]
-------------------------------------------------------------------------------------------------
const                            -3.6750      0.461     -7.964      0.000      -4.579      -2.771
EDAD                              0.0357      0.009      4.148      0.000       0.019       0.053
INGRESOS                       7.645e-05   8.51e-06      8.980      0.000    5.98e-05    9.31e-05
NUM_HIJOS                        -0.3592      0.085     -4.232      0.000      -0.526      -0.193
NUM_TARJETAS                     -0.2719      0.068     -3.990      0.000      -0.405      -0.138
PRESTAMOS                        -0.8442      0.118     -7.180      0.000      -1.075      -0.614
GENERO_Masculino                  0.0129      0.107      0.121      0.904      -0.196       0.222
ESTADO_CIVIL_Soltero              0.0940      0.184      0.510      0.610      -0.267       0.455
ESTADO_CIVIL_Viudo/Divorciado     3.7607      0.341     11.021      0.000       3.092       4.430
MODALIDAD_PAGO_Semanal           -0.4743      0.193     -2.458      0.014      -0.853      -0.096
HIPOTECA_SI                       0.4653      0.158      2.939      0.003       0.155       0.776
=================================================================================================</code></pre>
</div>
</div>
<div id="50c707e6" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"AIC:"</span>, modelo_LMultiple.aic)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"BIC:"</span>, modelo_LMultiple.bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 2324.974392300771
BIC: 2392.069489406911</code></pre>
</div>
</div>
<div id="8be49a7d" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_auc_score</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Se hace un nuevo modelo porque el AUC funciona con LogisticRegression en ves de sm.Logit</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>modelo_LMultiple2 <span class="op">=</span> LogisticRegression()</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>modelo_LMultiple2.fit(X_train, y_train)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>y_prob <span class="op">=</span> modelo_LMultiple2.predict_proba(X_test)[:, <span class="dv">1</span>]</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>auc <span class="op">=</span> roc_auc_score(y_test, y_prob)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"AUC:"</span>, auc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>AUC: 0.8320028889649143</code></pre>
</div>
</div>
<div id="5b934ddd" class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicción de probabilidades</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>predicciones <span class="op">=</span> modelo_LMultiple.predict(exog<span class="op">=</span> X_train)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>predicciones[<span class="dv">0</span>:<span class="dv">15</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="225">
<pre><code>4027    0.050553
507     0.676368
1741    0.054780
1260    0.195880
2596    0.023221
3892    0.045334
1051    0.310285
1192    0.076655
3733    0.022455
3918    0.028990
3025    0.041107
3448    0.271801
2940    0.138016
1817    0.070805
3995    0.043450
dtype: float64</code></pre>
</div>
</div>
<div id="e5e27b8b" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clasificación predicha</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>clasificacion <span class="op">=</span> np.where(predicciones<span class="op">&lt;</span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>pd.Series(clasificacion).value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="226">
<pre><code>0    2786
1     507
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="ridge" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="ridge"><span class="header-section-number">3.3</span> Ridge</h2>
<p>La regularización Ridge penaliza la suma de los coeficientes elevados al cuadrado. A esta penalización se le conoce como l2 y tiene el efecto de reducir de forma proporcional el valor de todos los coeficientes del modelo pero sin que estos lleguen a cero. El grado de penalización está controlado por el hiperparámetro /lambda. Cuando /lambda=0, la penalización es nula y el resultado es equivalente al de un modelo lineal por mínimos cuadrados ordinarios (OLS). A medida que /lambda aumenta, mayor es la penalización y menor el valor de los predictores.</p>
<p>El método ridge es capaz de reducir la varianza sin apenas aumentar el sesgo estimador (valor esperado de un estimador y el valor verdadero del parámetro), consiguiendo así un menor error total.</p>
<p>La desventaja del método ridge es que, el modelo final, incluye todos los predictores. Esto es así porque, si bien la pemalización fuerza a que los coefientes tiendan a cero, nunca llegan a ser exactamente cero (solo si /lambda=0).</p>
<div id="cb8fc522" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Lasso</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> ElasticNet</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> RidgeCV</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LassoCV</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> ElasticNetCV</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="d8ea3868" class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>modelo_Ridge <span class="op">=</span> make_pipeline(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    StandardScaler(),</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    RidgeCV(alphas<span class="op">=</span>np.logspace(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">200</span>), cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el modelo</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>modelo_Ridge <span class="op">=</span> modelo_Ridge.fit(X, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="247602d2" class="cell" data-execution_count="37">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Escalamos los datos (como haría StandardScaler en el pipeline)</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>X_esc <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos los valores de alpha</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">200</span>)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos los coeficientes para cada alpha</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>coefs <span class="op">=</span> []</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_intercept es False porque previamente habíamos escalado los datos</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> alpha <span class="kw">in</span> alphas:</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    modelo_temp <span class="op">=</span> Ridge(alpha<span class="op">=</span>alpha, fit_intercept<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    modelo_temp.fit(X_esc, y)</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    coefs.append(modelo_temp.coef_.flatten())</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficamos</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">4</span>))</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>ax.plot(alphas, coefs)</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>ax.set_ylim([<span class="op">-</span><span class="dv">15</span>, <span class="va">None</span>])</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'alpha'</span>)</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'coeficientes'</span>)</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Coeficientes del modelo Ridge en función de la regularización'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Notas_Python_files/figure-html/cell-38-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="a5561af2" class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir la grilla de alphas</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> np.logspace(<span class="op">-</span><span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">200</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el modelo con CV (por defecto usa leave-one-out si no se especifica)</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>modelo_ridgecv <span class="op">=</span> RidgeCV(alphas<span class="op">=</span>alphas, scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span>, cv<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>modelo_ridgecv.fit(X_esc, y)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el mejor alpha</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>mejor_alpha <span class="op">=</span> modelo_ridgecv.alpha_</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"El mejor alpha según CV es: </span><span class="sc">{</span>mejor_alpha<span class="sc">:.6f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>El mejor alpha según CV es: 0.000000</code></pre>
</div>
</div>
<div id="24524f78" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>modelo_lr <span class="op">=</span> LinearRegression()</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>modelo_lr.fit(X, y)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>mse_lr <span class="op">=</span> mean_squared_error(y, modelo_lr.predict(X))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="11e9a32b" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>modelo_ridge <span class="op">=</span> Ridge(alpha<span class="op">=</span><span class="fl">1e-3</span>)  <span class="co"># prueba con uno pequeño, como 0.001</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>modelo_ridge.fit(X, y)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>mse_ridge <span class="op">=</span> mean_squared_error(y, modelo_ridge.predict(X))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="bfa4e99c" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"MSE sin regularización: </span><span class="sc">{</span>mse_lr<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"MSE con Ridge(alpha=1e-3): </span><span class="sc">{</span>mse_ridge<span class="sc">:.4f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>MSE sin regularización: 0.1088
MSE con Ridge(alpha=1e-3): 0.1088</code></pre>
</div>
</div>
</section>
<section id="lasso" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="lasso"><span class="header-section-number">3.4</span> Lasso</h2>
<p>La regularización Lasso penaliza la suma del valor absoluto de los coeficientes de regresión. A esta penalización sse le como l1 y tiene el efecto de forzar a que los coeficientes de los predictores tiendan a cero. Dado que un predictor con coeficiente de regresión cero no influye en el modelo, lasso consigue excluir los predictores menos relevantes. Al igual que en ridge, el grado de penalización está controlado por el hiperparámetro /lambda. Cuando /lambda=0, el resultado es quivalente al de un modelo lineal por mínimos cuadrados ordinarios. A medida que /lambda aumenta, mayor es la penalización y más predictores quedan exluidos.</p>
<section id="comparación-ridge-y-lasso" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="comparación-ridge-y-lasso"><span class="header-section-number">3.4.1</span> Comparación Ridge y Lasso</h3>
<p>La principal diferencia práctica entre lasso y ridge es que el primero consigue que algunos coeficientes sean exactamente cero (0), por lo que realiza selección de predictoras, mientras que el segundo no llega a excluir ninguno. Esto supone una ventaja notable de lasso en escenarios donde no todos los predictoras son importantes para el modelo y se desea que los menos influyentes queden excluidos.</p>
</section>
</section>
<section id="elastin-net" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="elastin-net"><span class="header-section-number">3.5</span> Elastin net</h2>
<p>Elastic net incluye una regularización que combina la penalización l1 y l2. El grado en que influye cada una de las penalizaciones está controlado por el hiperparámetro. Cuando el hiperparámetro es 0 se aplica ridge y cuando el hiperparámetro es 1 se aplica lasso. La combinación de ambas penalizaciones suele dar lugar a buenos reultados.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>